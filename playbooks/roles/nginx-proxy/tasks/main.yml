---
- name: Install nginx
  yum: name=nginx state=present

- name: Create nginx conf
  template:
    src: nginx.conf.j2
    dest: /etc/nginx/nginx.conf
    validate: 'nginx -t -c %s'
  notify:
    - validate nginx configuration

- name: Create Horizon conf
  template:
    src: horizon.conf.j2
    dest: "{{ nginx_vhost_path }}/horizon.conf"

- name: Start Nginx
  service: name=nginx state=started
